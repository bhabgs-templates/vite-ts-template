!function(M,v,w){"use strict";function o(J,r){this.position=J,this.$22n=r}var h="ht",B=M[h],W=null,l=Math,O=l.PI,I=l.cos,m=l.sin,_=l.abs,Q=l.max,b=l.sqrt,P=1e-5,y=B.Default,i=y.def,D=y.startAnim,a=y.createMatrix,R=y.transformVec,g=y.getInternal(),U=g.addMethod,t=g.superCall,s=g.toPointsArray,z=g.createNormals,f=g.toFloatArray,d=g.glMV,S=(g.glPop,B.graph3d.Graph3dView,B.Math),e=S.Vector3,x=S.Matrix4,n=S.Euler,K=(S.Quaternion,g.batchShape),C=g.createNodeMatrix,r=g.getFaceInfo,Y=g.transformAppend,Z=g.drawFaceInfo,p=g.createAnim,A=g.cube(),L=A.is,F=A.vs,k=A.uv,q=g.ui(),X=B.Node,j=B.Shape,T="h",V="v",c="front",N="back",$="left",H="right",u="top",E="bottom",J="dw.expanded",G=".expanded",Tm="dw.angle",ib=".angle",Yb=function($,W,u){i(h+"."+$,W,u)},kf=function(a,e,r){r?a.push(e.x,e.y):a.push(e.x,e.y,e.z)},zl=function(){var y=new B.Math.Vector3,X=new B.Math.Vector3,G=new B.Math.Vector3;return function(o,J,x,D,Z){if(y.copy(J.$24n),X.copy(x.$24n),G.copy(D.$24n),!(G.equals(y)||X.equals(y)||X.equals(G))){if(!J.$22n||!x.$22n||!D.$22n){var Q=X.sub(y).cross(G.sub(y)).normalize().multiplyScalar(1).toArray();J.$22n||(J.$22n=new jj(Q)),x.$22n||(x.$22n=new jj(Q)),D.$22n||(D.$22n=new jj(Q))}o.push(new ls([J,x,D],Z))}}}(),jq=function(J,H,j,v){var E,M,k,u,i=0,d=[];if(v)for(E=v.length;E>i;i+=3)M=v[i],k=v[i+1],u=v[i+2],zl(d,new id([H[3*M],H[3*M+1],H[3*M+2]],null,j?[j[2*M],j[2*M+1],0]:W),new id([H[3*k],H[3*k+1],H[3*k+2]],null,j?[j[2*k],j[2*k+1],0]:W),new id([H[3*u],H[3*u+1],H[3*u+2]],null,j?[j[2*u],j[2*u+1],0]:W),J);else for(E=H.length/3;E>i;i+=3)M=i,k=i+1,u=i+2,zl(d,new id([H[3*M],H[3*M+1],H[3*M+2]],null,j?[j[2*M],j[2*M+1],0]:W),new id([H[3*k],H[3*k+1],H[3*k+2]],null,j?[j[2*k],j[2*k+1],0]:W),new id([H[3*u],H[3*u+1],H[3*u+2]],null,j?[j[2*u],j[2*u+1],0]:W),J);return d},kc=[$,c,H,N,u,E],Kp=["",u,E],gs=kc.concat("csg"),Lg=[0,6,12,18,24,30],Or=function(i,m,T){var J=C(i),d=[];i.appendAnchorMatrix3d(J);var e,$=m?m.getData3dUI(i):null;if($&&$.s("shape3d")&&!$.s("csg.cull.box")&&(e=$.shapeModel,$.shapeModel||(e=g.getShapeModel($,$.s("shape3d"))),e))for(var D=g.createNormalMatrix(J),S=0,B=Kp.length;B>S;S++){var c=Kp[S],o=c.length?c+"_":c,_=e[o+"vs"],H=e[o+"uv"],Z=e[o+"is"],v=e[o+"ns"];if(_&&_.length)for(var p,j,E,V=0,l=Z?Z.length:_.length/3;l>V;V+=3)Z?(p=Z[V],j=Z[V+1],E=Z[V+2]):(p=V,j=V+1,E=V+2),zl(d,new id(R([_[3*p],_[3*p+1],_[3*p+2]],J),v?R([v[3*p],v[3*p+1],v[3*p+2]],D):null,[H[2*p],H[2*p+1],0]),new id(R([_[3*j],_[3*j+1],_[3*j+2]],J),v?R([v[3*j],v[3*j+1],v[3*j+2]],D):null,[H[2*j],H[2*j+1],0]),new id(R([_[3*E],_[3*E+1],_[3*E+2]],J),v?R([v[3*E],v[3*E+1],v[3*E+2]],D):null,[H[2*E],H[2*E+1],0]),i)}if(!e)for(var S=0;6>S;S++)for(var c=kc[S],N=Lg[S],H=T?m.getFaceUv(i,c):W,s=T?m.getFaceUvScale(i,c):W,A=T?m.getFaceUvOffset(i,c):W,z=0;2>z;z++){var n,q,U,X=L[N+3*z],K=L[N+3*z+1],t=L[N+3*z+2];if(T){if(H){var f=8*S;n=[H[2*X-f],H[2*X+1-f],0],q=[H[2*K-f],H[2*K+1-f],0],U=[H[2*t-f],H[2*t+1-f],0]}else n=[k[2*X],k[2*X+1],0],q=[k[2*K],k[2*K+1],0],U=[k[2*t],k[2*t+1],0];s&&(n[0]*=s[0],n[1]*=s[1],q[0]*=s[0],q[1]*=s[1],U[0]*=s[0],U[1]*=s[1]),A&&(n[0]+=A[0],n[1]+=A[1],q[0]+=A[0],q[1]+=A[1],U[0]+=A[0],U[1]+=A[1])}zl(d,new id(R([F[3*X],F[3*X+1],F[3*X+2]],J),null,n),new id(R([F[3*K],F[3*K+1],F[3*K+2]],J),null,q),new id(R([F[3*t],F[3*t+1],F[3*t+2]],J),null,U),i)}return _d.$15n(d)},qf=function(Q,u){var x,B=Q.data.getAttaches();if(B&&B.each(function(l){l instanceof gp&&l.s("attach.operation")&&(x||(x=[]),x.push(l))}),x){var v;kc.forEach(function(m){var K=jq(m,Q[m].vs,Q[m].tuv);v=v?v.concat(K):K}),v=_d.$15n(v),x.forEach(function(t){var p=t.s("attach.operation");v[p]&&(v=v[p](Or(t,Q.gv,Q.csg.tuv)))}),kc.forEach(function(c){c=Q[c],c.vs=[],c.ns=[],c.tuv&&(c.tuv=[])}),Q.csg&&!Q.csg.ns&&(Q.csg.ns=[]);var h=[];if(v.$19n().forEach(function(E){var f,t=E.$10n;if(t instanceof gp){if(t.s("attach.cull"))return;f=t.s("csg.cull.color"),f&&(f=g.toColorArray(f)),t="csg"}for(var K=Q[t],c=K.vs,d=K.ns,J=K.tuv,k=E.$9n,O=2;O<k.length;O++)if(kf(c,k[0].$24n),kf(c,k[O-1].$24n),kf(c,k[O].$24n),d&&(kf(d,k[0].$22n),kf(d,k[O-1].$22n),kf(d,k[O].$22n)),J&&(kf(J,k[0].uv,!0),kf(J,k[O-1].uv,!0),kf(J,k[O].uv,!0)),f)for(var N=4*(c.length/3),r=0;3>r;r++)h[--N]=f[3],h[--N]=f[2],h[--N]=f[1],h[--N]=f[0]}),h.length){for(var c=g.toColorArray(Q.csg.color),J=0,T=4*(Q.csg.vs.length/3);T>J;J+=4)h[J]==w&&(h[J]=c[0],h[J+1]=c[1],h[J+2]=c[2],h[J+3]=c[3]);Q.csg.cs=h}}gs.forEach(function(r){var A=Q[r];A.visible&&A.vs.length?(A.ns&&A.ns.length?f(A,"ns"):A.ns=z(A.vs),f(A,"vs"),f(A,"tuv"),A.cs&&f(A,"cs")):delete Q[r]}),u&&(K(Q,W,u),Q.clear())};U(y,{createFrameModel:function(g,o,Z,S){g=g==W?.07:g,o=o==W?g:o,Z=Z==W?g:Z,S=S?S:{};var f=S.top,A=S.bottom,p=S.left,v=S.right,d=S.front,J=S.back,i=[],y=[];return d===!0?(i.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),y.push(0,0,0,1,1,1,1,1,1,0,0,0)):d===!1||(i.push(-.5,.5,.5,-.5,-.5,.5,-.5+g,-.5,.5,-.5+g,-.5,.5,-.5+g,.5,.5,-.5,.5,.5,.5-g,.5,.5,.5-g,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-g,.5,.5,-.5+g,.5,.5,-.5+g,.5-o,.5,.5-g,.5-o,.5,.5-g,.5-o,.5,.5-g,.5,.5,-.5+g,.5,.5,-.5+g,-.5+o,.5,-.5+g,-.5,.5,.5-g,-.5,.5,.5-g,-.5,.5,.5-g,-.5+o,.5,-.5+g,-.5+o,.5),y.push(0,0,0,1,g,1,g,1,g,0,0,0,1-g,0,1-g,1,1,1,1,1,1,0,1-g,0,g,0,g,o,1-g,o,1-g,o,1-g,0,g,0,g,1-o,g,1,1-g,1,1-g,1,1-g,1-o,g,1-o)),J===!0?(i.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),y.push(1,0,0,1,1,1,0,1,1,0,0,0)):J===!1||(i.push(-.5,.5,-.5,-.5+g,-.5,-.5,-.5,-.5,-.5,-.5+g,-.5,-.5,-.5,.5,-.5,-.5+g,.5,-.5,.5-g,.5,-.5,.5,-.5,-.5,.5-g,-.5,-.5,.5,-.5,-.5,.5-g,.5,-.5,.5,.5,-.5,-.5+g,.5,-.5,.5-g,.5-o,-.5,-.5+g,.5-o,-.5,.5-g,.5-o,-.5,-.5+g,.5,-.5,.5-g,.5,-.5,-.5+g,-.5+o,-.5,.5-g,-.5,-.5,-.5+g,-.5,-.5,.5-g,-.5,-.5,-.5+g,-.5+o,-.5,.5-g,-.5+o,-.5),y.push(1,0,1-g,1,1,1,1-g,1,1,0,1-g,0,g,0,0,1,g,1,0,1,g,0,0,0,1-g,0,g,o,1-g,o,g,o,1-g,0,g,0,1-g,1-o,g,1,1-g,1,g,1,1-g,1-o,g,1-o)),p===!0?(i.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),y.push(0,0,0,1,1,1,1,1,1,0,0,0)):p===!1||(i.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+Z,-.5,-.5,-.5+Z,-.5,.5,-.5+Z,-.5,.5,-.5,-.5,.5,.5-Z,-.5,-.5,.5-Z,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-Z,-.5,.5,-.5+Z,-.5,.5-o,-.5+Z,-.5,.5-o,.5-Z,-.5,.5-o,.5-Z,-.5,.5,.5-Z,-.5,.5,-.5+Z,-.5,-.5+o,-.5+Z,-.5,-.5,-.5+Z,-.5,-.5,.5-Z,-.5,-.5,.5-Z,-.5,-.5+o,.5-Z,-.5,-.5+o,-.5+Z),y.push(0,0,0,1,Z,1,Z,1,Z,0,0,0,1-Z,0,1-Z,1,1,1,1,1,1,0,1-Z,0,Z,0,Z,o,1-Z,o,1-Z,o,1-Z,0,Z,0,Z,1-o,Z,1,1-Z,1,1-Z,1,1-Z,1-o,Z,1-o)),v===!0?(i.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),y.push(1,0,0,1,1,1,0,1,1,0,0,0)):v===!1||(i.push(.5,.5,-.5,.5,-.5,-.5+Z,.5,-.5,-.5,.5,-.5,-.5+Z,.5,.5,-.5,.5,.5,-.5+Z,.5,.5,.5-Z,.5,-.5,.5,.5,-.5,.5-Z,.5,-.5,.5,.5,.5,.5-Z,.5,.5,.5,.5,.5,-.5+Z,.5,.5-o,.5-Z,.5,.5-o,-.5+Z,.5,.5-o,.5-Z,.5,.5,-.5+Z,.5,.5,.5-Z,.5,-.5+o,-.5+Z,.5,-.5,.5-Z,.5,-.5,-.5+Z,.5,-.5,.5-Z,.5,-.5+o,-.5+Z,.5,-.5+o,.5-Z),y.push(1,0,1-Z,1,1,1,1-Z,1,1,0,1-Z,0,Z,0,0,1,Z,1,0,1,Z,0,0,0,1-Z,0,Z,o,1-Z,o,Z,o,1-Z,0,Z,0,1-Z,1-o,Z,1,1-Z,1,Z,1,1-Z,1-o,Z,1-o)),f===!0?(i.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),y.push(1,1,1,0,0,0,0,0,0,1,1,1)):f===!1||(i.push(.5,.5,.5,.5,.5,-.5,.5-g,.5,-.5,.5-g,.5,-.5,.5-g,.5,.5,.5,.5,.5,-.5+g,.5,.5,-.5+g,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+g,.5,.5,.5-g,.5,.5,.5-g,.5,.5-Z,-.5+g,.5,.5-Z,-.5+g,.5,.5-Z,-.5+g,.5,.5,.5-g,.5,.5,.5-g,.5,-.5+Z,.5-g,.5,-.5,-.5+g,.5,-.5,-.5+g,.5,-.5,-.5+g,.5,-.5+Z,.5-g,.5,-.5+Z),y.push(1,1,1,0,1-g,0,1-g,0,1-g,1,1,1,g,1,g,0,0,0,0,0,0,1,g,1,1-g,1,1-g,1-Z,g,1-Z,g,1-Z,g,1,1-g,1,1-g,Z,1-g,0,g,0,g,0,g,Z,1-g,Z)),A===!0?(i.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),y.push(1,0,0,1,1,1,0,1,1,0,0,0)):A===!1||(i.push(.5,-.5,.5,.5-g,-.5,-.5,.5,-.5,-.5,.5-g,-.5,-.5,.5,-.5,.5,.5-g,-.5,.5,-.5+g,-.5,.5,-.5,-.5,-.5,-.5+g,-.5,-.5,-.5,-.5,-.5,-.5+g,-.5,.5,-.5,-.5,.5,.5-g,-.5,.5,-.5+g,-.5,.5-Z,.5-g,-.5,.5-Z,-.5+g,-.5,.5-Z,.5-g,-.5,.5,-.5+g,-.5,.5,.5-g,-.5,-.5+Z,-.5+g,-.5,-.5,.5-g,-.5,-.5,-.5+g,-.5,-.5,.5-g,-.5,-.5+Z,-.5+g,-.5,-.5+Z),y.push(1,0,1-g,1,1,1,1-g,1,1,0,1-g,0,g,0,0,1,g,1,0,1,g,0,0,0,1-g,0,g,Z,1-g,Z,g,Z,1-g,0,g,0,1-g,1-Z,g,1,1-g,1,g,1,1-g,1-Z,g,1-Z)),{vs:i,uv:y}}}),U(B.Style,{"csg.cull.color":w,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":w,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":O/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),kc.forEach(function(S){var r={};r[S+G]=!1,r[S+".toggleable"]=!1,r[S+".axis"]=$,r[S+".start"]=0,r[S+".end"]=O/2,r[S+ib]=0,U(B.Style,r,!0)});var _d=function(){this.$4n=[]};_d.$15n=function(E){var Z=new _d;return Z.$4n=E,Z},_d.prototype={clone:function(){var n=new _d;return n.$4n=this.$4n.map(function(M){return M.clone()}),n},$19n:function(){return this.$4n},union:function(O){var e=new Kc(this.clone().$4n),t=new Kc(O.clone().$4n);return e.$3n(t),t.$3n(e),t.$6n(),t.$3n(e),t.$6n(),e.$7n(t.$2n()),_d.$15n(e.$2n())},subtract:function(A){var B=new Kc(this.clone().$4n),y=new Kc(A.clone().$4n);return B.$6n(),B.$3n(y),y.$3n(B),y.$6n(),y.$3n(B),y.$6n(),B.$7n(y.$2n()),B.$6n(),_d.$15n(B.$2n())},intersect:function(g){var J=new Kc(this.clone().$4n),k=new Kc(g.clone().$4n);return J.$6n(),k.$3n(J),k.$6n(),J.$3n(k),k.$3n(J),J.$7n(k.$2n()),J.$6n(),_d.$15n(J.$2n())},inverse:function(){var A=this.clone();return A.$4n.map(function(x){x.flip()}),A}},_d.cube=function(F){F=F||{};var M=new jj(F.center||[0,0,0]),e=F.radius?F.radius.length?F.radius:[F.radius,F.radius,F.radius]:[1,1,1];return _d.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(T){return new ls(T[0].map(function(y){var k=new jj(M.x+e[0]*(2*!!(1&y)-1),M.y+e[1]*(2*!!(2&y)-1),M.z+e[2]*(2*!!(4&y)-1));return new id(k,new jj(T[1]))}))}))},_d.sphere=function(J){function s(h,r){h*=2*O,r*=O;var $=new jj(I(h)*m(r),I(r),m(h)*m(r));w.push(new id(q.$20n($.$21n(y)),$))}J=J||{};for(var w,q=new jj(J.center||[0,0,0]),y=J.radius||1,l=J.slices||16,g=J.stacks||8,z=[],v=0;l>v;v++)for(var $=0;g>$;$++)w=[],s(v/l,$/g),$>0&&s((v+1)/l,$/g),g-1>$&&s((v+1)/l,($+1)/g),s(v/l,($+1)/g),z.push(new ls(w));return _d.$15n(z)},_d.cylinder=function(L){function Z(J,U,B){var D=2*U*O,j=W.$21n(I(D)).$20n(i.$21n(m(D))),Q=t.$20n(p.$21n(J)).$20n(j.$21n(x)),H=j.$21n(1-_(B)).$20n(b.$21n(B));return new id(Q,H)}L=L||{};for(var t=new jj(L.start||[0,-1,0]),q=new jj(L.end||[0,1,0]),p=q.$13n(t),x=L.radius||1,e=L.slices||16,b=p.$14n(),o=_(b.y)>.5,W=new jj(o,!o,0).cross(b).$14n(),i=W.cross(b).$14n(),w=new id(t,b.$11n()),y=new id(q,b.$14n()),R=[],h=0;e>h;h++){var E=h/e,M=(h+1)/e;R.push(new ls([w,Z(0,E,-1),Z(0,M,-1)])),R.push(new ls([Z(0,M,0),Z(0,E,0),Z(1,E,0),Z(1,M,0)])),R.push(new ls([y,Z(1,M,1),Z(1,E,1)]))}return _d.$15n(R)};var jj=function(J,r,i){var g=this;3==arguments.length?(g.x=J,g.y=r,g.z=i):"x"in J?(g.x=J.x,g.y=J.y,g.z=J.z):(g.x=J[0],g.y=J[1],g.z=J[2])};jj.prototype={clone:function(){return new jj(this.x,this.y,this.z)},$11n:function(){return new jj(-this.x,-this.y,-this.z)},$20n:function(s){return new jj(this.x+s.x,this.y+s.y,this.z+s.z)},$13n:function(G){return new jj(this.x-G.x,this.y-G.y,this.z-G.z)},$21n:function(H){return new jj(this.x*H,this.y*H,this.z*H)},$16n:function(H){return new jj(this.x/H,this.y/H,this.z/H)},dot:function(j){return this.x*j.x+this.y*j.y+this.z*j.z},lerp:function(j,H){return this.$20n(j.$13n(this).$21n(H))},length:function(){return b(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(p){var V=this;return new jj(V.y*p.z-V.z*p.y,V.z*p.x-V.x*p.z,V.x*p.y-V.y*p.x)}};var id=function(i,G,v){var F=this;F.$24n=new jj(i),F.$22n=G?new jj(G):null,F.uv=v?new jj(v):null};id.prototype={clone:function(){var O=this;return new id(O.$24n.clone(),O.$22n.clone(),O.uv?O.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(R,c){var v=this;return new id(v.$24n.lerp(R.$24n,c),v.$22n.lerp(R.$22n,c),v.uv?v.uv.lerp(R.uv,c):null)}};var xs=function(w,T){this.$22n=w,this.w=T};xs.$17n=function(B,r,E){var c=r.$13n(B).cross(E.$13n(B)).$14n();return new xs(c,c.dot(B))},xs.prototype={clone:function(){return new xs(this.$22n.clone(),this.w)},flip:function(){var B=this;B.$22n=B.$22n.$11n(),B.w=-B.w},$5n:function(y,g,r,l,G){for(var M=this,Z=0,K=1,H=2,b=3,E=0,R=[],o=0;o<y.$9n.length;o++){var A=M.$22n.dot(y.$9n[o].$24n)-M.w,q=-P>A?H:A>P?K:Z;E|=q,R.push(q)}switch(E){case Z:(M.$22n.dot(y.$8n.$22n)>0?g:r).push(y);break;case K:l.push(y);break;case H:G.push(y);break;case b:for(var F=[],U=[],o=0;o<y.$9n.length;o++){var B=(o+1)%y.$9n.length,N=R[o],I=R[B],a=y.$9n[o],u=y.$9n[B];if(N!=H&&F.push(a),N!=K&&U.push(N!=H?a.clone():a),(N|I)==b){var A=(M.w-this.$22n.dot(a.$24n))/M.$22n.dot(u.$24n.$13n(a.$24n)),T=a.$18n(u,A);F.push(T),U.push(T.clone())}}F.length>=3&&l.push(new ls(F,y.$10n)),U.length>=3&&G.push(new ls(U,y.$10n))}}};var ls=function(B,k){var Y=this;Y.$9n=B,Y.$10n=k,Y.$8n=xs.$17n(B[0].$24n,B[1].$24n,B[2].$24n)};ls.prototype={clone:function(){var M=this.$9n.map(function(U){return U.clone()});return new ls(M,this.$10n)},flip:function(){this.$9n.reverse().map(function(S){S.flip()}),this.$8n.flip()}};var Kc=function(E){var R=this;R.$8n=null,R.front=null,R.back=null,R.$4n=[],E&&R.$7n(E)};Kc.prototype={clone:function(){var f=this,q=new Kc;return q.$8n=f.$8n&&f.$8n.clone(),q.front=f.front&&f.front.clone(),q.back=f.back&&f.back.clone(),q.$4n=f.$4n.map(function(h){return h.clone()}),q},$6n:function(){for(var m=this,N=0;N<m.$4n.length;N++)m.$4n[N].flip();m.$8n&&m.$8n.flip(),m.front&&m.front.$6n(),m.back&&m.back.$6n();var Z=m.front;m.front=m.back,m.back=Z},$1n:function(T){var m=this;if(!m.$8n)return T.slice();for(var X=[],C=[],J=0;J<T.length;J++)m.$8n.$5n(T[J],X,C,X,C);return m.front&&(X=m.front.$1n(X)),C=m.back?m.back.$1n(C):[],X.concat(C)},$3n:function(t){var e=this;e.$4n=t.$1n(e.$4n),e.front&&e.front.$3n(t),e.back&&e.back.$3n(t)},$2n:function(){var j=this,b=j.$4n.slice();return j.front&&(b=b.concat(j.front.$2n())),j.back&&(b=b.concat(j.back.$2n())),b},$7n:function(P){var O=this;if(P.length){O.$8n||(O.$8n=P[0].$8n.clone());for(var m=[],V=[],S=0;S<P.length;S++)this.$8n.$5n(P[S],O.$4n,O.$4n,m,V);m.length&&(O.front||(O.front=new Kc),this.front.$7n(m)),V.length&&(O.back||(O.back=new Kc),O.back.$7n(V))}}};var Oq="symbol",ao=B.Symbol=function(X,M,B){var p=this;t(ao,p),p.s3(20,20,20),p.s({"all.visible":!1,shape:"rect"}),p.setIcon(X,M,B)};Yb("Symbol",X,{setIcon:function(r,i,u){var c,V=this;return ao.superClass.setIcon.call(V,r),r?(c={for3d:!0,face:"center",position:44,names:[r]},u&&(c.transaprent=!0),i&&(c.autorotate=i),V.addStyleIcon(Oq,c)):V.removeStyleIcon(Oq),V.setWidth(g.getImageWidth(y.getImage(r),V)||20),c}});var gp=B.CSGNode=function(){t(gp,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})},$p={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1};Yb("CSGNode",X,{_22Q:function(){return Rm},onPropertyChanged:function(_){var P=this,r=P.getHost();gp.superClass.onPropertyChanged.call(P,_),$p[_.property]&&(r instanceof mk||r instanceof gp)&&r.fp("csgNodeChange",!0,!1)}});var Rm=function(h,c){t(Rm,this,[h,c])};i(Rm,q.Node3dUI,{_80o:function(_,e,D){var U=this;U._shape3d?Rm.superClass._80o.call(U,_,e,D):(d(U.gv),gs.forEach(function(J){Z(U,_,e,J,D)}))},validate:function(M,V){var u=this,O=u.gv,N=u.data;if(N.s("shape3d"))return Rm.superClass.validate.call(u,M,V),u._shape3d=!0,void 0;u._shape3d=!1;var $=C(N,O.getMat(N));N.appendAnchorMatrix3d($);var P=M&&M.uv;u.vf2("csg",P);for(var f=0;6>f;f++)for(var K=kc[f],j=Lg[f],s=u.vf2(K,P,V),X=s.mat||$,n=s.vs,B=s.uv,G=s.tuv,i=0;2>i;i++){var h=L[j+3*i],d=L[j+3*i+1],w=L[j+3*i+2];if(Y(n,X,[F[3*h],F[3*h+1],F[3*h+2]]),Y(n,X,[F[3*d],F[3*d+1],F[3*d+2]]),Y(n,X,[F[3*w],F[3*w+1],F[3*w+2]]),G)if(B){var o=8*f;G.push(B[2*h-o],B[2*h+1-o],B[2*d-o],B[2*d+1-o],B[2*w-o],B[2*w+1-o])}else G.push(k[2*h],k[2*h+1],k[2*d],k[2*d+1],k[2*w],k[2*w+1])}qf(u,M,V)},vf2:function(S,O,f){var q,T=this,H=T.gv.getFaceVisible(T.data,S);return q=r(T,S,f),q.vs=[],q.tuv=H&&(q.texture||O)?[]:W,q.visible=H,q}});var mk=B.CSGShape=function(){var h=this;t(mk,h),h.s({"shape.background":W,"2d.hostable":!0,"shape.border.width":8}),h.setTall(240),h.setElevation(120),h.setThickness(14)};Yb("CSGShape",j,{IRotatable:!1,_22Q:function(){return Zb},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setSegments:function(){}});var Zb=function(I,N){t(Zb,this,[I,N])};i(Zb,q.Shape3dUI,{_80o:function(G,r,M){var p=this;p.undrawable||(d(p.gv),gs.forEach(function(V){Z(p,G,r,V,M)}))},validate:function(F,x){var Z=this,m=Z.data,h=m.getPoints();if(Z.undrawable=h.size()<2)return Z.clear(),void 0;var E=m.isClosePath(),p=Q(m._thickness/2,P),w=s(h,W,W,E);gs.forEach(function(k){Z.vf(k,F&&F.uv,!0,x)}),E&&(Z.left.visible=!1,Z.right.visible=!1),Z._12O(w,p),Z._20Q(w);var d=m.getPointsMatrix3d(),N=B.Math.requestVector3();kc.forEach(function(V){if(Z[V])for(var M=Z[V].vs,m=0,G=M.length;G>m;m+=3)N.set(M[m],M[m+1],M[m+2]).applyMatrix4(d),M[m]=N.x,M[m+1]=N.y,M[m+2]=N.z}),B.Math.releaseVector3(N),qf(Z,F,x)}});var Nf=B.DoorWindow=function(){var A=this;t(Nf,A),A.setElevation(100),A.s3(100,200,14)};Yb("DoorWindow",gp,{IDoorWindow:!0,toggle:function(l){this.setExpanded(!this.s(J),l)},isExpanded:function(){return this.s(J)},setExpanded:function(F,h){var A=this,d=A.$25n,q=A.getDataModel(),G=A.s(J);if(d&&(d.stop(!0),delete A.$25n),G!==F){q&&q.beginTransaction();var s=F?A.s("dw.end"):A.s("dw.start");A.s(J,F),h=p(h),h?(G=A.s(Tm),h.action=function(m){A.s(Tm,G+(s-G)*m)},h.finishFunc=function(){q&&q.endTransaction()},A.$25n=D(h)):(A.s(Tm,s),q&&q.endTransaction())}},getMat:function(){var y=this,b=y.s("dw.s3"),q=y.s("dw.t3"),Q=y.s("dw.flip"),k=y.s(Tm);if(b||k||q||Q){var z=[];if(Q&&z.push({r3:[0,O,0]}),b&&z.push({s3:b}),k){b=y.getFinalScale3d();var i=y.s("dw.axis"),C=b[0]/2,L=b[1]/2;b[2]/2,i===$?z.push({t3:[C,0,0]},{r3:[0,-k,0]},{t3:[-C,0,0]}):i===H?z.push({t3:[-C,0,0]},{r3:[0,k,0]},{t3:[C,0,0]}):i===u?z.push({t3:[0,-L,0]},{r3:[-k,0,0]},{t3:[0,L,0]}):i===E?z.push({t3:[0,L,0]},{r3:[k,0,0]},{t3:[0,-L,0]}):i===V?z.push({r3:[0,k,0]}):i===T&&z.push({r3:[k,0,0]})}return q&&z.push({t3:q}),a(z)}return W}});var sg=B.CSGBox=function(){var F=this;t(sg,F),F.setElevation(100),F.s3(100,200,100)};Yb("CSGBox",gp,{ICSGBox:!0,toggleFace:function(Z,w){this.setFaceExpanded(Z,!this.s(Z+G),w)},isFaceExpanded:function(T){return this.s(T+G)},setFaceExpanded:function(P,K,O){var I=this,H=I.$25n,h=I.s(P+G);if(H&&(H.stop(!0),delete I.$25n),h!==K){var b=K?I.s(P+".end"):I.s(P+".start");I.s(P+G,K),O=p(O),O?(h=I.s(P+ib),O.action=function(D){I.s(P+ib,h+(b-h)*D)},I.$25n=D(O)):I.s(P+ib,b)}},getFaceMat:function(q){var $=this,n=$.s(q+ib);if(!n)return W;var b,Z,g,w,D,o,T=$.s(q+".axis"),p=$.getFinalScale3d(),h=$.getAnchor3d(),J=p[0]*h.x,X=p[1]*h.y,r=p[2]*h.z,x=p[0]-J,E=p[1]-X,B=p[2]-r,K=q+"_"+T;switch(K){case"front_left":b=-J,Z=0,g=B,w=0,D=-n,o=0;break;case"front_right":b=x,Z=0,g=B,w=0,D=n,o=0;break;case"front_top":b=0,Z=E,g=B,w=-n,D=0,o=0;break;case"front_bottom":b=0,Z=-X,g=B,w=n,D=0,o=0;break;case"front_h":b=0,Z=0,g=B,w=n,D=0,o=0;break;case"front_v":b=0,Z=0,g=B,w=0,D=n,o=0;break;case"back_left":b=x,Z=0,g=-r,w=0,D=-n,o=0;break;case"back_right":b=-J,Z=0,g=-r,w=0,D=n,o=0;break;case"back_top":b=0,Z=E,g=-r,w=n,D=0,o=0;break;case"back_bottom":b=0,Z=-X,g=-r,w=-n,D=0,o=0;break;case"back_h":b=0,Z=0,g=-r,w=n,D=0,o=0;break;case"back_v":b=0,Z=0,g=-r,w=0,D=n,o=0;break;case"left_left":b=-J,Z=0,g=-r,w=0,D=-n,o=0;break;case"left_right":b=-J,Z=0,g=B,w=0,D=n,o=0;break;case"left_top":b=-J,Z=E,g=0,w=0,D=0,o=-n;break;case"left_bottom":b=-J,Z=-X,g=0,w=0,D=0,o=n;break;case"left_h":b=-J,Z=0,g=0,w=0,D=0,o=n;break;case"left_v":b=-J,Z=0,g=0,w=0,D=n,o=0;break;case"right_left":b=x,Z=0,g=B,w=0,D=-n,o=0;break;case"right_right":b=x,Z=0,g=-r,w=0,D=n,o=0;break;case"right_top":b=x,Z=E,g=0,w=0,D=0,o=n;break;case"right_bottom":b=x,Z=-X,g=0,w=0,D=0,o=-n;break;case"right_h":b=x,Z=0,g=0,w=0,D=0,o=n;break;case"right_v":b=x,Z=0,g=0,w=0,D=n,o=0;break;case"top_left":b=-J,Z=E,g=0,w=0,D=0,o=n;break;case"top_right":b=x,Z=E,g=0,w=0,D=0,o=-n;break;case"top_top":b=0,Z=E,g=-r,w=-n,D=0,o=0;break;case"top_bottom":b=0,Z=E,g=B,w=n,D=0,o=0;break;case"top_h":b=0,Z=E,g=0,w=n,D=0,o=0;break;case"top_v":b=0,Z=E,g=0,w=0,D=0,o=n;break;case"bottom_left":b=-J,Z=-X,g=0,w=0,D=0,o=-n;break;case"bottom_right":b=x,Z=-X,g=0,w=0,D=0,o=n;break;case"bottom_top":b=0,Z=-X,g=B,w=-n,D=0,o=0;break;case"bottom_bottom":b=0,Z=-X,g=-r,w=n,D=0,o=0;break;case"bottom_h":b=0,Z=-X,g=0,w=n,D=0,o=0;break;case"bottom_v":b=0,Z=-X,g=0,w=0,D=0,o=n}return a([{t3:[-b,-Z,-g]},{r3:[w,D,o]},{t3:[b,Z,g]}])}});var pr=function(y,C,M,w,D){function N(){var J,d=[],H=new e,y=new e;for(Y.eachShapeModel(function(q,p,T){for(var h=0,Z=p?p.length:q.length/3;Z>h;h++)p?(H.fromArray(q,3*p[h]),y.fromArray(T,3*p[h])):(H.fromArray(q,3*h),y.fromArray(T,3*h)),K(d,H,y)}),d=Z(d,z.set(1,0,0)),d=Z(d,z.set(-1,0,0)),d=Z(d,z.set(0,1,0)),d=Z(d,z.set(0,-1,0)),d=Z(d,z.set(0,0,1)),d=Z(d,z.set(0,0,-1)),J=0;J<d.length;J++){var U=d[J];g.push(.5+U.position.x/D.x,.5-U.position.y/D.y),U.position.applyMatrix4(A),E.push(U.position.x,U.position.y,U.position.z),h.push(U.$22n.x,U.$22n.y,U.$22n.z)}}function K(S,C,i){C.applyMatrix4(a),C.applyMatrix4(d),i.transformDirection(a),i.transformDirection(d),S.push(new o(C.clone(),i.clone()))}function Z(v,M){for(var P=[],o=.5*Math.abs(D.dot(M)),l=0;l<v.length;l+=3){var f,I,g,a,e,$,U,r=0,R=v[l+0].position.dot(M)-o,F=v[l+1].position.dot(M)-o,b=v[l+2].position.dot(M)-o;switch(f=R>0,I=F>0,g=b>0,r=(f?1:0)+(I?1:0)+(g?1:0)){case 0:P.push(v[l]),P.push(v[l+1]),P.push(v[l+2]);break;case 1:if(f&&(a=v[l+1],e=v[l+2],$=c(v[l],a,M,o),U=c(v[l],e,M,o)),I){a=v[l],e=v[l+2],$=c(v[l+1],a,M,o),U=c(v[l+1],e,M,o),P.push($),P.push(e.clone()),P.push(a.clone()),P.push(e.clone()),P.push($.clone()),P.push(U);break}g&&(a=v[l],e=v[l+1],$=c(v[l+2],a,M,o),U=c(v[l+2],e,M,o)),P.push(a.clone()),P.push(e.clone()),P.push($),P.push(U),P.push($.clone()),P.push(e.clone());break;case 2:f||(a=v[l].clone(),e=c(a,v[l+1],M,o),$=c(a,v[l+2],M,o),P.push(a),P.push(e),P.push($)),I||(a=v[l+1].clone(),e=c(a,v[l+2],M,o),$=c(a,v[l],M,o),P.push(a),P.push(e),P.push($)),g||(a=v[l+2].clone(),e=c(a,v[l],M,o),$=c(a,v[l+1],M,o),P.push(a),P.push(e),P.push($));break;case 3:}}return P}function c(T,$,n,N){var a=T.position.dot(n)-N,L=$.position.dot(n)-N,c=a/(a-L),U=new o(new e(T.position.x+c*($.position.x-T.position.x),T.position.y+c*($.position.y-T.position.y),T.position.z+c*($.position.z-T.position.z)),new e(T.$22n.x+c*($.$22n.x-T.$22n.x),T.$22n.y+c*($.$22n.y-T.$22n.y),T.$22n.z+c*($.$22n.z-T.$22n.z)));return U}var E=[],h=[],g=[],z=new e,Y=y.getData3dUI(C);if(Y.mat){var a=(new x).fromArray(Y.mat),b=new x;b.makeRotationFromEuler(w),b.setPosition(M);var d=(new x).getInverse(b),A=(new x).scale({x:1/D.x,y:1/D.y,z:1/D.z});return N(),{vs:E,ns:h,uv:g}}};o.prototype.clone=function(){return new o(this.position.clone(),this.$22n.clone())};var hs=function(N,Z,h,Y){var X=this,s=X.getDataAt(N);if(s){var U=X.intersectObject(N,s);if(U){"object"==typeof Z?Z=Z.x?new e(Z.x,Z.y,Z.z):new e(Z[0],Z[1],Z[2]):(Z=Z||20,Z=new e(Z,Z,Z)),h=h===w?.1:h;var M=new e(X.getUp()),u=new e(X.getCenter()).sub(new e(X.getEye())).normalize(),i="cross",G=u.clone()[i](M).normalize();M.copy(G)[i](u).normalize(),Y&&M.applyAxisAngle(U.worldNormal,-Y);var p=new B.Node,r=U.worldNormal.clone().setLength(h).add(U.world),v=(new x).lookAt(U.worldNormal.clone(),new e(0,0,0),M),V=(new n).setFromRotationMatrix(v),I=pr(X,s,U.world.clone(),V,Z);return p.p3(r.x,r.y,r.z),p.setEuler(V),p.s3(Z.x,Z.y,Z.z),p.s({shape3d:I,"shape3d.reverse.flip":!0}),p}}};U(B.graph3d.Graph3dView,{createDecal:hs})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);